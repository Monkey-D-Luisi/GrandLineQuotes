# Esto se incluye dentro de http {} por el nginx.conf base
map $http_accept_language $lang {
    default en;
    "~^es"   es;  # es, es-ES, es-MX...
}

server {
    listen 80;
    server_name _;
    root /usr/share/nginx/html;
    index privacy_en.html;

    # / y /privacy.html -> /privacy (negociación segun $lang)
    location = /            { return 301 /privacy; }
    location = /privacy.html{ return 301 /privacy; }

    # /privacy -> sirve privacy_$lang.html si existe
    location /privacy {
        try_files /privacy_$lang.html =404;
    }

    # Rutas fijas
    location /en/privacy { alias /usr/share/nginx/html/privacy_en.html; }
    location /es/privacy { alias /usr/share/nginx/html/privacy_es.html; }

    # Cache básico para los html directos
    location ~* ^/privacy_(en|es)\.html$ {
        add_header Cache-Control "public, max-age=3600";
    }
}
